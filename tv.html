<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV Pro Player (Football Edition)</title>
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #e50914;
            --bg-dark: #0f0f0f;
            --bg-panel: #161616;
            --text-color: #e0e0e0;
            --text-secondary: #888;
            --hover-color: #333;
            --border-color: #2a2a2a;
            --input-bg: #111;
            --input-border: #444;
            --header-height: 60px;
            --footer-height: 40px;
            --tabs-height: 50px; /* Ø§Ø±ØªÙØ§Ø¹ Ø´Ø±ÙŠØ· Ø§Ù„ØªØ¨ÙˆÙŠØ¨ */
        }

        body.light-mode {
            --bg-dark: #ffffff;
            --bg-panel: #f4f4f4;
            --text-color: #333;
            --text-secondary: #666;
            --hover-color: #e0e0e0;
            --border-color: #ccc;
            --input-bg: #fff;
            --input-border: #ccc;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-color);
            font-family: 'Cairo', sans-serif;
            margin: 0;
            padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- Header --- */
        header {
            height: var(--header-height);
            background-color: var(--bg-panel);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            flex-shrink: 0;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--text-color);
        }

        .logo svg {
            fill: var(--primary-color);
            width: 24px;
            height: 24px;
        }

        .theme-toggle {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 20px;
            font-family: inherit;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: 0.3s;
        }

        .theme-toggle:hover { background-color: var(--hover-color); }

        /* --- Video Section --- */
        .video-section {
            width: 100%;
            background: #000;
            flex-shrink: 0;
            position: relative;
        }

        .video-wrapper {
            width: 100%;
            height: 100%;
            max-height: 40vh; 
            margin: 0 auto;
        }
        
        @media (min-height: 800px) { .video-wrapper { max-height: 45vh; } }

        .plyr { height: 100%; width: 100%; }
        video { object-fit: contain; }

        /* --- Tabs Bar (Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª) --- */
        .tabs-bar {
            display: flex;
            height: var(--tabs-height);
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border-color);
            flex-shrink: 0;
        }

        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s;
            border-bottom: 3px solid transparent;
        }

        .tab-btn:hover { color: var(--text-color); background: var(--hover-color); }
        
        .tab-btn.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background: rgba(229, 9, 20, 0.05);
        }

        /* --- Main Content Area --- */
        .content-area {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        /* Tab Content Containers */
        .tab-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none; /* Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹ */
            flex-direction: row; /* Ù„Ù„Ù‚Ù†ÙˆØ§Øª */
        }

        .tab-content.active {
            display: flex; /* Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø´Ø· ÙÙ‚Ø· */
        }

        /* --- IPTV Layout (Tab 1) --- */
        .list-section {
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 100%;
        }

        .countries-list {
            width: 35%;
            background: var(--bg-panel);
            border-left: 1px solid var(--border-color);
        }

        .channels-list {
            width: 65%;
            background: var(--bg-dark);
        }

        .search-box {
            padding: 10px;
            background: var(--bg-panel);
            border-bottom: 1px solid var(--border-color);
        }

        .search-box input {
            width: 100%;
            padding: 8px 10px;
            border-radius: 4px;
            border: 1px solid var(--input-border);
            background: var(--input-bg);
            color: var(--text-color);
            outline: none;
        }

        .search-box input:focus { border-color: var(--primary-color); }

        .scrollable-list {
            flex: 1;
            overflow-y: auto;
            padding-bottom: 20px;
        }

        .item {
            padding: 10px 12px;
            border-bottom: 1px solid var(--border-color);
            cursor: pointer;
            display: flex;
            align-items: center;
        }

        .item:hover { background-color: var(--hover-color); }

        .item.active {
            background-color: rgba(229, 9, 20, 0.15);
            border-right: 3px solid var(--primary-color);
        }

        .item img {
            width: 24px;
            height: 24px;
            margin-left: 10px;
            border-radius: 50%;
            object-fit: contain;
            background: #000;
        }

        .item span {
            font-size: 13px;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* --- Football Layout (Tab 2) --- */
        #football-tab {
            flex-direction: column;
            overflow: scroll;
            background: var(--bg-dark);
            padding: 10px;
        }

        .status-msg {
            text-align: center;
            padding: 20px;
            color: var(--text-secondary);
            font-size: 14px;
        }

        footer {
            height: var(--footer-height);
            background-color: var(--bg-panel);
            border-top: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-panel); }
        ::-webkit-scrollbar-thumb { background: #555; border-radius: 3px; }

        @media (max-width: 768px) {
            .countries-list { width: 40%; }
            .channels-list { width: 60%; }
            .logo span { display: none; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">
            <svg viewBox="0 0 24 24"><path d="M21 3H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5v2h8v-2h5c1.1 0 1.99-.9 1.99-2L23 5c0-1.1-.9-2-2-2zm0 14H3V5h18v12z"/></svg>
            <span>IPTV Player</span>
        </div>
        <button class="theme-toggle" id="theme-btn" onclick="toggleTheme()">
            <span id="theme-icon">â˜€ï¸</span> 
            <span id="theme-text">Light Mode</span>
        </button>
    </header>

    <div class="video-section">
        <div class="video-wrapper">
            <video id="player" playsinline controls crossorigin>
                <source src="" type="application/x-mpegURL" />
            </video>
        </div>
    </div>

    <div class="tabs-bar">
        <button class="tab-btn active" onclick="switchTab('iptv')">ğŸ“º Ø§Ù„Ù‚Ù†ÙˆØ§Øª (Channels)</button>
        <button class="tab-btn" onclick="switchTab('football')">âš½ Ø§Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª (Matches)</button>
    </div>

    <div class="content-area">
        
        <div id="iptv-tab" class="tab-content active">
            <div class="list-section countries-list">
                <div class="search-box">
                    <input type="text" id="search-country" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ø¯ÙˆÙ„Ø©..." onkeyup="filterList('countries-container', this.value)">
                </div>
                <div id="countries-container" class="scrollable-list">
                    <div class="status-msg">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
                </div>
            </div>

            <div class="list-section channels-list">
                <div class="search-box">
                    <input type="text" id="search-channel" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ù‚Ù†Ø§Ø©..." onkeyup="filterList('channels-container', this.value)">
                </div>
                <div id="channels-container" class="scrollable-list">
                    <div class="status-msg">ğŸ‘ˆ Ø§Ø®ØªØ± Ø¯ÙˆÙ„Ø©</div>
                </div>
            </div>
        </div>

        <div id="football-tab" class="tab-content">
            <div style="font-size:12px; color: #666; text-align:center; padding:5px;">
                Ø¥Ø°Ø§ Ù„Ù… ÙŠØ¸Ù‡Ø± Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø£Ø¯Ù†Ø§Ù‡ØŒ ØªØ£ÙƒØ¯ Ù…Ù† ØªÙØ¹ÙŠÙ„ "Allowed Domains" ÙÙŠ Ø­Ø³Ø§Ø¨Ùƒ Ø¹Ù„Ù‰ API-Football
            </div>
            
            <div id="widget-container">
                <api-sports-widget data-type="leagues"></api-sports-widget>
                <api-sports-widget data-type="config"
                    data-key="219afb927d14c7f9ba7132adf83e0a4f"
                    data-sport="football"
                    data-lang="ar"
                    data-theme="dark"
                    data-show-errors="true"
                ></api-sports-widget>
            </div>
        </div>

    </div>
<hr> <br>
    <footer>
        <p>
        Copyright &copy; Ø¹Ù…Ø§Ø¯ Ø§Ù„Ø¯ÙŠÙ† Ù„Ù…Ø±Ø§Ù†ÙŠ
        </p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <script type="module" src="https://widgets.api-sports.io/2.0.3/widgets.js"></script>

    <script>
        // --- Tab Switching Logic ---
        function switchTab(tabName) {
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙƒÙ„Ø§Ø³ Ø§Ù„Ù†Ø´Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            // ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø²Ø± ÙˆØ§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            if(tabName === 'iptv') {
                document.querySelector('button[onclick="switchTab(\'iptv\')"]').classList.add('active');
                document.getElementById('iptv-tab').classList.add('active');
            } else {
                document.querySelector('button[onclick="switchTab(\'football\')"]').classList.add('active');
                document.getElementById('football-tab').classList.add('active');
            }
        }

        // --- IPTV Logic ---
        const countriesContainer = document.getElementById('countries-container');
        const channelsContainer = document.getElementById('channels-container');
        const videoElement = document.getElementById('player');
        let player, hls;

        function initPlayer(sourceUrl) {
            if (Hls.isSupported()) {
                if(hls) hls.destroy();
                hls = new Hls();
                hls.loadSource(sourceUrl);
                hls.attachMedia(videoElement);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    if (!player) player = new Plyr(videoElement, { controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 'fullscreen'] });
                    videoElement.play().catch(e => {});
                });
            } else if (videoElement.canPlayType('application/vnd.apple.mpegurl')) {
                videoElement.src = sourceUrl;
                if (!player) player = new Plyr(videoElement);
                videoElement.play();
            }
        }

        // Theme Toggle (ÙŠØ´Ù…Ù„ Ø§Ù„ÙˆÙŠØ¯Ø¬Øª)
        function toggleTheme() {
            const body = document.body;
            const btnText = document.getElementById('theme-text');
            const btnIcon = document.getElementById('theme-icon');
            const widgetConfig = document.querySelector('api-sports-widget[data-type="config"]');
            
            body.classList.toggle('light-mode');
            
            if (body.classList.contains('light-mode')) {
                btnText.textContent = "Dark Mode";
                btnIcon.textContent = "ğŸŒ™";
                if(widgetConfig) widgetConfig.setAttribute('data-theme', 'white');
            } else {
                btnText.textContent = "Light Mode";
                btnIcon.textContent = "â˜€ï¸";
                if(widgetConfig) widgetConfig.setAttribute('data-theme', 'dark');
            }
        }

        // Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        async function fetchCountries() {
            try {
                const response = await fetch('https://iptv-org.github.io/api/countries.json');
                const data = await response.json();
                const sorted = data.sort((a, b) => a.name.localeCompare(b.name));
                renderCountries(sorted);
            } catch (error) {
                countriesContainer.innerHTML = '<div class="status-msg">Ø®Ø·Ø£ Ø§ØªØµØ§Ù„</div>';
            }
        }

        function renderCountries(list) {
            countriesContainer.innerHTML = '';
            list.forEach(country => {
                if (country.name && country.code) {
                    const div = document.createElement('div');
                    div.className = 'item';
                    div.innerHTML = `<img src="https://flagcdn.com/w40/${country.code.toLowerCase()}.png" loading="lazy" onerror="this.src='https://via.placeholder.com/20'"><span>${country.name}</span>`;
                    div.onclick = () => loadCountryChannels(country.code, country.name, div);
                    div.setAttribute('data-name', country.name.toLowerCase());
                    countriesContainer.appendChild(div);
                }
            });
        }

        async function loadCountryChannels(code, name, element) {
            document.querySelectorAll('.countries-list .item').forEach(i => i.classList.remove('active'));
            element.classList.add('active');
            channelsContainer.innerHTML = `<div class="status-msg">ØªØ­Ù…ÙŠÙ„ ${name}...</div>`;
            
            try {
                const res = await fetch(`https://iptv-org.github.io/iptv/countries/${code.toLowerCase()}.m3u`);
                if (!res.ok) throw new Error("No channels");
                const text = await res.text();
                const channels = parseM3U(text);
                renderChannels(channels.length ? channels : []);
                if(!channels.length) channelsContainer.innerHTML = '<div class="status-msg">Ù„Ø§ Ù‚Ù†ÙˆØ§Øª</div>';
            } catch (e) {
                channelsContainer.innerHTML = '<div class="status-msg">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ¯Ø±</div>';
            }
        }

        function parseM3U(content) {
            const lines = content.split('\n');
            const channels = [];
            let current = {};
            for (let line of lines) {
                line = line.trim();
                if (line.startsWith('#EXTINF:')) {
                    const logo = (line.match(/tvg-logo="([^"]*)"/) || [])[1] || '';
                    const name = line.split(',').pop().trim();
                    current = { name, logo };
                } else if (line.startsWith('http')) {
                    current.url = line;
                    channels.push(current);
                    current = {};
                }
            }
            return channels;
        }

        function renderChannels(channels) {
            channelsContainer.innerHTML = '';
            channels.forEach(ch => {
                const div = document.createElement('div');
                div.className = 'item';
                div.innerHTML = `<img src="${ch.logo}" loading="lazy" onerror="this.src='https://via.placeholder.com/40'"><span>${ch.name}</span>`;
                div.onclick = () => initPlayer(ch.url);
                div.setAttribute('data-name', ch.name.toLowerCase());
                channelsContainer.appendChild(div);
            });
        }

        function filterList(id, val) {
            const items = document.getElementById(id).getElementsByClassName('item');
            Array.from(items).forEach(item => {
                item.style.display = item.getAttribute('data-name').includes(val.toLowerCase()) ? 'flex' : 'none';
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            player = new Plyr(videoElement, { controls: ['play-large', 'play', 'progress', 'current-time', 'mute', 'volume', 'fullscreen'] });
            fetchCountries();
        });
    </script>
</body>
</html>
